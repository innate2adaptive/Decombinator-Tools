# How to run Decombinator jobs on the UCL CS HPC cluster

*This guide is only relevant for members of the Innate2Adaptive group at UCL. At present it is designed to work with batches that have samples generated by a single protocol (e.g. RACE).*

1. You will need access to the UCL CS HPC cluster which can be requested [here](https://hpc.cs.ucl.ac.uk/account-form/).
2. You will need to be added to the `inn2adap` user group to get access to our project storage. Request this when you obtain your login details.
3. Create a new batch directory in the project directory and place your `.tar` file there.
    - See the UCL CS HPC [website](https://hpc.cs.ucl.ac.uk/ssh-scp/) for information on how to set up port-forwarding if you need to `scp` data to the cluster.
4. Copy the contents of `Decombinator-Tools/v4.3_cs_cluster_scripts` to your batch directory.
5. Check `dcr_job.qsub.sh` to make sure it has the correct pipeline settings for your data.
    - If you have samples processed by different protocols in your batch, you will have to split them manually and edit `unpack_and_submit.sh` to skip the already completed steps.
6. Run `source unpack_and_submit.sh` to submit all samples in the `.tar` file to the job scheduler.
7. Check if your jobs begin running successfully with `qstat`.
8. Create a `.csv` with your batch name and the order in which you would like your samples presented in the summary sheet.
9. Once all jobs are complete, run `source repack_and_summarise.sh` to package the results for transfer to the RDS.
